select * from import_item where transaction_seq in
(
 select max(transaction_seq)
 from import_item
 where transaction_seq < 24363
 and part_item_id = 10145
 and location_id = 255
)


select * from export_item where transaction_seq in
(
 select max(transaction_seq)
 from export_item
 where transaction_seq < 24363
 and part_item_id = 10145
 and location_id = 255
)

 select max(transaction_seq)
 from export_item
 where transaction_seq > 0
 and part_item_id = 10145
 and location_id = 255

 select *
 from import_item
 where part_item_id = 10145
 and location_id = 255
 and transaction_seq < 24363


SELECT EI.PART_ITEM_ID, EI.PIG_ID, EI.HOUSE_ID, SUM(EI.EXPORT_AMOUNT * EI.EXPORT_AVG_PRICE) EXPORT_TOTAL_PRICE
FROM EXPORT_ITEM EI
LEFT OUTER JOIN PART_ITEM PI ON (EI.PIG_ID = PI.PART_ITEM_ID)
LEFT OUTER JOIN INVENTORY_DOC IVD ON (EI.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID)
WHERE (EI.PIG_ID IS NOT NULL)
AND (PI.PIG_TYPE IN ('G', 'B', 'BT', 'R'))
AND (IVD.COMMIT_FLAG = 'Y')
GROUP BY EI.PART_ITEM_ID, EI.PIG_ID, EI.HOUSE_ID


SELECT SUM(II.IMPORT_AMOUNT)
FROM IMPORT_ITEM II
LEFT OUTER JOIN PART_ITEM PI ON (II.PART_ITEM_ID = PI.PART_ITEM_ID)
LEFT OUTER JOIN INVENTORY_DOC IVD ON (II.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID)
WHERE (PI.PIG_FLAG = 'Y')
AND (IVD.COMMIT_FLAG = 'Y')
AND (IVD.DOCUMENT_TYPE = 5)


SELECT CM.DOCUMENT_DATE, CM.DOCUMENT_NO, MI.PIG_ID, MI.FROM_HOUSE_ID, MI.TO_HOUSE_ID
FROM CAPITAL_MOVEMENT

SELECT DISTINCT CM.DOCUMENT_DATE, CM.DOCUMENT_NO, CM.DOCUMENT_CATEGORY, CM.DOCUMENT_TYPE, MI.PIG_ID, MI.FROM_HOUSE_ID, MI.TO_HOUSE_ID, MI.PIG_STATUS
FROM MOVEMENT_ITEM MI
LEFT OUTER JOIN CAPITAL_MOVEMENT CM ON (CM.CAPITAL_MOVEMENT_ID = MI.CAPITAL_MOVEMENT_ID)
ORDER BY MI.FROM_HOUSE_ID, MI.PIG_ID

SELECT CM.DOCUMENT_DATE, CM.DOCUMENT_NO, CM.DOCUMENT_CATEGORY, CM.DOCUMENT_TYPE, MI.PIG_ID, MI.FROM_HOUSE_ID, MI.TO_HOUSE_ID, MI.PIG_STATUS,
   SUM (MI.CAPITAL_AMOUNT)
FROM MOVEMENT_ITEM MI
LEFT OUTER JOIN CAPITAL_MOVEMENT CM ON (CM.CAPITAL_MOVEMENT_ID = MI.CAPITAL_MOVEMENT_ID)
LEFT OUTER JOIN PART_ITEM PI ON (MI.PART_ITEM_ID = PI.PART_ITEM_ID)
LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID)
LEFT OUTER JOIN PART_GROUP PG ON (PT.PART_GROUP_ID = PG.PART_GROUP_ID)
GROUP BY CM.DOCUMENT_DATE, CM.DOCUMENT_NO, CM.DOCUMENT_CATEGORY, CM.DOCUMENT_TYPE, MI.PIG_ID, MI.FROM_HOUSE_ID, MI.TO_HOUSE_ID, MI.PIG_STATUS

SELECT MI.FROM_HOUSE_ID, MI.PIG_ID, PG.PART_GROUP_ID, MI.EXPENSE_TYPE, SUM(MI.CAPITAL_AMOUNT) CAPITAL_AMOUNT
FROM MOVEMENT_ITEM MI
LEFT OUTER JOIN CAPITAL_MOVEMENT CM ON (MI.CAPITAL_MOVEMENT_ID = CM.CAPITAL_MOVEMENT_ID)
LEFT OUTER JOIN PART_ITEM PI ON (MI.PART_ITEM_ID = PI.PART_ITEM_ID)
LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID)
LEFT OUTER JOIN PART_GROUP PG ON (PT.PART_GROUP_ID = PG.PART_GROUP_ID)
GROUP BY MI.FROM_HOUSE_ID, MI.PIG_ID, PG.PART_GROUP_ID, MI.EXPENSE_TYPE
WHERE (MI.FROM_HOUSE_ID =)
AND (MI.PIG_ID = )

SELECT DISTINCT II.LOCATION_ID, II.PART_ITEM_ID, II.PIG_STATUS
FROM IMPORT_ITEM II


SELECT II.LOCATION_ID, II.PART_ITEM_ID, II.PIG_STATUS, SUM(II.IMPORT_AMOUNT) IMPORT_AMOUNT
FROM IMPORT_ITEM II
GROUP BY II.LOCATION_ID, II.PART_ITEM_ID, II.PIG_STATUS

SELECT II.LOCATION_ID, II.PART_ITEM_ID, II.PIG_STATUS, SUM(II.IMPORT_AMOUNT) IMPORT_AMOUNT
FROM IMPORT_ITEM II
GROUP BY II.LOCATION_ID, II.PART_ITEM_ID, II.PIG_STATUS

SELECT CM.PIG_STATUS, SUM(CM.TX_AMOUNT) TX_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT, SUM(DI.TOTAL_PRICE) TOTAL_PRICE
FROM CAPITAL_MOVEMENT CM
LEFT OUTER JOIN EXPORT_ITEM EI ON (CM.EXPORT_ITEM_ID = EI.EXPORT_ITEM_ID)
LEFT OUTER JOIN DO_ITEM DI ON (DI.LINK_ID = EI.LINK_ID)
WHERE CM.DOCUMENT_TYPE = 10
AND CM.EXPORT_ITEM_ID IS NOT NULL
GROUP BY CM.PIG_STATUS


SELECT CM.PIG_STATUS, SUM(CM.TX_AMOUNT) TX_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT, SUM(DI.TOTAL_PRICE) TOTAL_PRICE
FROM CAPITAL_MOVEMENT CM, EXPORT_ITEM EI, DO_ITEM DI, INVENTORY_DOC IVD, BILLING_DOC BLD
WHERE (CM.EXPORT_ITEM_ID = EI.EXPORT_ITEM_ID)
AND (DI.DO_ID = BLD.BILLING_DOC_ID)
AND (EI.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID)
AND (BLD.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID)
AND (EI.LINK_ID = DI.LINK_ID)
AND CM.DOCUMENT_TYPE = 10
AND CM.DOCUMENT_CATEGORY = 1
GROUP BY CM.PIG_STATUS


SELECT CM.PIG_STATUS, SUM(CM.TX_AMOUNT) TX_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT, SUM(DI.TOTAL_PRICE) TOTAL_PRICE 
FROM CAPITAL_MOVEMENT CM, EXPORT_ITEM EI, DO_ITEM DI, INVENTORY_DOC IVD, BILLING_DOC BLD 
WHERE (CM.EXPORT_ITEM_ID = EI.EXPORT_ITEM_ID)
AND (DI.DO_ID = BLD.BILLING_DOC_ID)
AND (EI.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) 
AND (BLD.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) 
AND (EI.LINK_ID = DI.LINK_ID) 
AND (CM.DOCUMENT_TYPE = 10) 
AND (CM.DOCUMENT_CATEGORY = 1) 
GROUP BY CM.PIG_STATUS ORDER BY CM.PIG_STATUS DESC 


SELECT SUM(-1 * MI.CAPITAL_AMOUNT)
FROM MOVEMENT_ITEM MI
LEFT OUTER JOIN CAPITAL_MOVEMENT CM ON (MI.CAPITAL_MOVEMENT_ID = CM.CAPITAL_MOVEMENT_ID)
WHERE (CM.DOCUMENT_TYPE = 10) 
AND (CM.DOCUMENT_CATEGORY = 1) 
GROUP BY CM.PIG_STATUS


/*****/

DELETE FROM IMPORT_ITEM;

DELETE FROM EXPORT_ITEM;

DELETE FROM DO_ITEM;

DELETE FROM RO_ITEM;

DELETE FROM RECEIPT_ITEM;

DELETE FROM INVENTORY_DOC;

DELETE FROM BILLING_DOC;

DELETE FROM PART_LOCATION;

/*****/