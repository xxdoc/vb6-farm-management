VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "CDoItem"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

Private m_Conn As ADODB.Connection

Public AddEditMode As SHOW_MODE_TYPE
Public QueryFlag As Long
Public OrderBy As Long
Public OrderType As Long
Public Flag As String
' End of generic data member

Public DO_ITEM_ID As Long
Public DO_ID As Long
Public PART_ITEM_ID As Long
Public LOCATION_ID As Long
Public ITEM_AMOUNT As Double
Public TOTAL_WEIGHT As Double
Public STATUS_WEIGHT  As String
Public AVG_WEIGHT As Double
Public TOTAL_PRICE As Double
Public AVG_PRICE As Double
Public GUI_ID As Long
Public LINK_ID As Long
Public PIG_STATUS As Long
Public REVENUE_ID As Long
Public PIG_AGE As Double
Public AGE_CODE As String
Public PEDIGREE_COST As Double

Public TAKE_AWAY_FLAG As String
Public TAKE_KEY_ACCOUNT As String

Public BATCH_ID As Long
Public SIMULATE_FLAG As String
Public FROM_DATE As Date
Public TO_DATE As Date
Public VALID_DATE As Date
Public COMMIT_FLAG As String
Public PIG_TYPE As String
Public PART_NO As String
Public PIG_STATUS_NO As String
Public PIG_STATUS_NAME As String
Public LOCATION_NO As String
Public LOCATION_NAME As String
Public LOCATION_TYPE As String
Public PART_DESC As String
Public PART_TYPE As Long
Public PART_TYPE_NAME As String
Public DOCUMENT_TYPE As Long
Public DOCUMENT_SUBTYPE As Long
Public RECEIPT_TYPE As Long
Public ACCOUNT_ID As Long
Public CUSTOMER_CODE As String
Public CUSTOMER_NAME As String
Public DOCUMENT_NO As String
Public DOCUMENT_DATE As Date
Public CUSTOMER_ID As Long
Public REVENUE_NO As String
Public REVENUE_NAME As String
Public CUSTOMER_TYPE As Long
Public PIG_FLAG As String
Public EXPORT_TOTAL_PRICE As Double
Public YYYYMM As String
Public YYYYMM2 As String
Public PRODUCT_TYPE_GROUP As Long
Public PRDTYP_GRP_NAME As String
Public PRDTYP_GRP_NO As String

Public PKG_TYPE As Long
Public DISCOUNT_PERCENT As Double
Public DISCOUNT_AMOUNT As Double
Public DISCOUNT_REASON As String
Public SHOW_AVG As String
Public PRODUCT_STATUS_NO As String
Public PRODUCT_STATUS_NAME As String
Public NON_SALE_FLAG As String
Public UNIT_NAME As String

Public PART_TYPE_NO  As String

Public PART_GROUP_ID As Long
Public PART_GROUP_NAME  As String

Public SubLotItems As Collection

'-----------------------> สำหรับเป็นต้นทุนที่ใช้ของ งาน Simulate
Public BBIRTH_AMOUNT As Double
Public BFOOD_AMOUNT As Double
Public BMEDICINE_AMOUNT As Double
Public BEXPENSE_AMOUNT As Double
Public BIRTH_AMOUNT As Double
Public FOOD_AMOUNT As Double
Public MEDICINE_AMOUNT As Double
Public OTHER_AMOUNT As Double
Public EXPENSE_AMOUNT As Double
'-----------------------> สำหรับเป็นต้นทุนที่ใช้ของ งาน Simulate
Public EMP_ID As Long
Public EMP_CODE As String
Public EMP_LONGNAME As String
Public FROM_EMP_CODE As String
Public TO_EMP_CODE As String
'-----------------------> รายงานเรียงตาม Sale

Public PRODUCT_STATUS_ID As Long
Public YEAR_SEQ_ID  As Long
Public WEEK_NO As String

Public CREATE_DATE As Date

Public DocTypeSet As String
Public DocSubTypeSet As String
Public RevenueFlag As String



Private Sub Class_Initialize()
   Set m_Conn = glbDatabaseMngr.DBConnection
   FROM_DATE = -1
   TO_DATE = -1
   VALID_DATE = -1
End Sub

'In this class we will not handle any error or any transaction
Public Function QueryData(Ind As Long, Rs As ADODB.Recordset, itemcount As Long)
Dim SQL1 As String
Dim SQL2 As String
Dim SelectStr1 As String
Dim SelectStr2 As String
Dim FromStr As String
Dim WhereStr As String
Dim OrderByStr As String
Dim OrderTypeStr As String
Dim TempDate As String
Dim SubLen As Long
Dim NewStr As String
Dim GroupByStr As String

   SIMULATE_FLAG = glbUser.SIMULATE_FLAG
   If Ind = 1 Then
      SelectStr1 = "SELECT DI.*, PT.*, LC.*, PI.*, UN.*, PS.*, IVD.DOCUMENT_DATE, IVD.DOCUMENT_NO, IVD.COMMIT_FLAG, IVD.DOCUMENT_TYPE, RT.* "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOCATION LC ON (DI.LOCATION_ID = LC.LOCATION_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN UNIT UN ON (PI.UNIT_COUNT = UN.UNIT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (DI.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
      WhereStr = ""
   ElseIf Ind = 2 Then
      SelectStr1 = "SELECT BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      
      WhereStr = "WHERE (DI.REVENUE_ID IS NULL) "
   ElseIf Ind = 3 Then
      SelectStr1 = "SELECT BD.ACCOUNT_ID, BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      
      WhereStr = ""
   ElseIf Ind = 4 Then
      SelectStr1 = "SELECT DI.DO_ID, DI.PIG_STATUS, DI.ITEM_AMOUNT, DI.TOTAL_WEIGHT, DI.TOTAL_PRICE,DI.DISCOUNT_AMOUNT, "
      SelectStr1 = SelectStr1 & "BD.DOCUMENT_NO, BD.DOCUMENT_DATE, NM.LONG_NAME CUSTOMER_NAME "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = "WHERE (DI.PIG_STATUS IS NOT NULL) "
   ElseIf Ind = 5 Then
      SelectStr1 = "SELECT DI.DO_ID, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = ""
   ElseIf Ind = 6 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT  "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = ""
   ElseIf Ind = 7 Then
      SelectStr1 = "SELECT DI.REVENUE_ID, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      
      WhereStr = "WHERE (DI.REVENUE_ID IS NOT NULL) "
   ElseIf Ind = 8 Then
      SelectStr1 = "SELECT BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      
      WhereStr = "WHERE (DI.REVENUE_ID IS NOT NULL) "
   ElseIf Ind = 9 Then
      SelectStr1 = "SELECT DISTINCT CM.CUSTOMER_ID, DI.PART_ITEM_ID, EM.EMP_ID, EM.EMP_CODE, ENM.LONG_NAME , PT.PART_TYPE_NAME , PI.PIG_FLAG  "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (BD.ACCEPT_BY = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE_NAME EN ON (EN.EMP_ID = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME ENM ON (ENM.NAME_ID = EN.NAME_ID) "
      
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 10 Then
      SelectStr1 = "SELECT EM.EMP_ID , CM.CUSTOMER_ID, DI.PART_ITEM_ID ,SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(EI.EXPORT_TOTAL_PRICE) EXPORT_TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "

      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (BD.ACCEPT_BY = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE_NAME EN ON (EN.EMP_ID = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME ENM ON (ENM.NAME_ID = EN.NAME_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 11 Then
      SelectStr1 = "SELECT DISTINCT CM.CUSTOMER_ID, DI.REVENUE_ID "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "

      WhereStr = ""
   ElseIf Ind = 12 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, DI.REVENUE_ID,  SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "

      WhereStr = ""
   ElseIf Ind = 13 Then
      SelectStr1 = "SELECT DI.DO_ID, BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      
      WhereStr = "WHERE (DI.REVENUE_ID IS NULL) "
   ElseIf Ind = 14 Then
      SelectStr1 = "SELECT DI.DO_ID, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      
      WhereStr = "WHERE (DI.REVENUE_ID IS NOT NULL) "
   ElseIf Ind = 15 Then     'CReportInventory060        'เดิมคิดต้นทุนด้วยแต่เปลี่ยนเป็นเอาจากตาราง Capitalmovement เมื่อวันที่ 05/08/2552
      'SelectStr1 = "SELECT DI.PART_ITEM_ID, DI.PIG_AGE, DI.PIG_STATUS, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(EI.EXPORT_TOTAL_PRICE) EXPORT_TOTAL_PRICE, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = "SELECT DI.PART_ITEM_ID, DI.PIG_AGE, DI.PIG_STATUS, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      'FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      If YEAR_SEQ_ID > 0 Or Len(WEEK_NO) > 0 Then
         FromStr = FromStr & "LEFT OUTER JOIN PRTITEM_MAP PM ON (PI.PART_ITEM_ID = PM.PART_ITEM_ID) "
         FromStr = FromStr & "LEFT OUTER JOIN YEAR_WEEK YW ON (YW.YEAR_WEEK_ID = PM.YEAR_WEEK_ID) "
         FromStr = FromStr & "LEFT OUTER JOIN YEAR_SEQ YQ ON (YQ.YEAR_SEQ_ID = YW.YEAR_SEQ_ID) "
      End If
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 16 Then
      SelectStr1 = "SELECT BD.YYYYMM, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr1 = SelectStr1 & ",SUM(DI.BFOOD_AMOUNT) BFOOD_AMOUNT,SUM(DI.BEXPENSE_AMOUNT) BEXPENSE_AMOUNT,SUM(DI.BBIRTH_AMOUNT) BBIRTH_AMOUNT,SUM(DI.BIRTH_AMOUNT) BIRTH_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.FOOD_AMOUNT) FOOD_AMOUNT,SUM(DI.EXPENSE_AMOUNT) EXPENSE_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.BMEDICINE_AMOUNT) BMEDICINE_AMOUNT,SUM(DI.MEDICINE_AMOUNT) MEDICINE_AMOUNT,SUM(DI.OTHER_AMOUNT) OTHER_AMOUNT "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 17 Then
      SelectStr1 = "SELECT BD.YYYYMM, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.REVENUE_ID IS NOT NULL) "
   ElseIf Ind = 18 Then
      SelectStr1 = "SELECT BD.YYYYMM2, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 19 Then
      SelectStr1 = "SELECT BD.YYYYMM2, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.REVENUE_ID IS NOT NULL) "
   ElseIf Ind = 20 Then
      SelectStr1 = "SELECT DI.PIG_STATUS, BD.YYYYMM, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
      Call SearchPartNo(WhereStr)
            
   ElseIf Ind = 21 Then
      SelectStr1 = "SELECT DI.REVENUE_ID, BD.YYYYMM, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.REVENUE_ID IS NOT NULL) "
   ElseIf Ind = 22 Then
      SelectStr1 = "SELECT DISTINCT DI.PIG_STATUS, PS.PRODUCT_STATUS_NO, PS.PRODUCT_STATUS_NAME, ST.STATUS_TYPE_NO PRDTYP_GRP_NO, ST.STATUS_TYPE_NAME PRDTYP_GRP_NAME "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN STATUS_TYPE ST ON (PS.STATUS_TYPE = ST.STATUS_TYPE_ID) "
      
      WhereStr = ""
   ElseIf Ind = 23 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME CUSTOMER_NAME, DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, DI.* "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO,RT.REVENUE_NAME,PT.PART_TYPE_NAME "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CN.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM1 ON (NM1.NAME_ID = CN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      'FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN STATUS_TYPE ST ON (PS.STATUS_TYPE = ST.STATUS_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      'WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 24 Then
      SelectStr1 = "SELECT DISTINCT DI.PIG_STATUS, PS.PRODUCT_STATUS_NO, PS.PRODUCT_STATUS_NAME, PI.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PIG_TYPE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN STATUS_TYPE ST ON (PS.STATUS_TYPE = ST.STATUS_TYPE_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 25 Then
      SelectStr1 = "SELECT DI.PART_ITEM_ID, DI.PIG_STATUS, BD.YYYYMM, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
   
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 26 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME CUSTOMER_NAME, DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, BD.CREATE_DATE "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO,RT.REVENUE_NAME,PT.PART_TYPE_NAME "
      SelectStr1 = SelectStr1 & ",SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CN.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM1 ON (NM1.NAME_ID = CN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      'FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN STATUS_TYPE ST ON (PS.STATUS_TYPE = ST.STATUS_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      'WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 27 Then
      SelectStr1 = "SELECT PI.PART_NO, PI.PIG_TYPE, PS.PRODUCT_STATUS_NO,DI.PIG_AGE "
      SelectStr1 = SelectStr1 & ",BD.DOCUMENT_DATE "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO "
      SelectStr1 = SelectStr1 & ",SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(EI.EXPORT_TOTAL_PRICE) EXPORT_TOTAL_PRICE "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
      WhereStr = "WHERE (RT.REVENUE_NO IS NOT NULL OR (PI.PART_NO IS NOT NULL AND PI.PIG_TYPE IS NOT NULL AND PS.PRODUCT_STATUS_NO IS NOT NULL AND DI.PIG_AGE IS NOT NULL)) "
   ElseIf Ind = 28 Then
      SelectStr1 = "SELECT BD.DOCUMENT_DATE, DI.TOTAL_PRICE, DI.TOTAL_WEIGHT, DI.ITEM_AMOUNT "
      SelectStr1 = SelectStr1 & ",DI.BFOOD_AMOUNT,DI.BEXPENSE_AMOUNT,DI.BBIRTH_AMOUNT,DI.BIRTH_AMOUNT "
      SelectStr1 = SelectStr1 & ",DI.FOOD_AMOUNT,DI.EXPENSE_AMOUNT,DI.BMEDICINE_AMOUNT,DI.MEDICINE_AMOUNT,DI.OTHER_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      Call SearchPartNo(WhereStr)
   ElseIf Ind = 29 Then
      SelectStr1 = "SELECT  SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT , SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.BFOOD_AMOUNT) BFOOD_AMOUNT,SUM(DI.BEXPENSE_AMOUNT) BEXPENSE_AMOUNT,SUM(DI.BBIRTH_AMOUNT) BBIRTH_AMOUNT,SUM(DI.BIRTH_AMOUNT) BIRTH_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.FOOD_AMOUNT) FOOD_AMOUNT,SUM(DI.EXPENSE_AMOUNT) EXPENSE_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.BMEDICINE_AMOUNT) BMEDICINE_AMOUNT,SUM(DI.MEDICINE_AMOUNT) MEDICINE_AMOUNT,SUM(DI.OTHER_AMOUNT) OTHER_AMOUNT "
      SelectStr1 = SelectStr1 & ",PS.PRODUCT_STATUS_NAME "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      Call SearchPartNo(WhereStr)
   ElseIf Ind = 30 Then
      SelectStr1 = "SELECT  SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT , SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.BFOOD_AMOUNT) BFOOD_AMOUNT,SUM(DI.BEXPENSE_AMOUNT) BEXPENSE_AMOUNT,SUM(DI.BBIRTH_AMOUNT) BBIRTH_AMOUNT,SUM(DI.BIRTH_AMOUNT) BIRTH_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.FOOD_AMOUNT) FOOD_AMOUNT,SUM(DI.EXPENSE_AMOUNT) EXPENSE_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(DI.BMEDICINE_AMOUNT) BMEDICINE_AMOUNT,SUM(DI.MEDICINE_AMOUNT) MEDICINE_AMOUNT,SUM(DI.OTHER_AMOUNT) OTHER_AMOUNT "
      SelectStr1 = SelectStr1 & ",PS.PRODUCT_STATUS_NAME,PI.PART_NO,PI.PIG_TYPE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      Call SearchPartNo(WhereStr)
   ElseIf Ind = 31 Then
      SelectStr1 = "SELECT DI.PIG_AGE,DI.TOTAL_WEIGHT, DI.ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
    
    
    ElseIf Ind = 32 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, DI.ITEM_AMOUNT,DI.TOTAL_WEIGHT,DI.TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
    ElseIf Ind = 33 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 34 Then
       SelectStr1 = "SELECT DI.*, PT.*, LC.*, PI.*, UN.*, PS.*, IVD.DOCUMENT_DATE, IVD.DOCUMENT_NO, IVD.COMMIT_FLAG, IVD.DOCUMENT_TYPE, RT.*, CM.CUSTOMER_CODE, NM.LONG_NAME CUSTOMER_NAME "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOCATION LC ON (DI.LOCATION_ID = LC.LOCATION_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN UNIT UN ON (PI.UNIT_COUNT = UN.UNIT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (DI.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = ""
  ElseIf Ind = 35 Then
      SelectStr1 = "SELECT DISTINCT CM.CUSTOMER_ID, DI.PART_ITEM_ID, EM.EMP_ID, EM.EMP_CODE, ENM.LONG_NAME , PT.PART_TYPE_NAME , PI.PIG_FLAG, PS.PRODUCT_STATUS_ID , PS.PRODUCT_STATUS_NO , PS.PRODUCT_STATUS_NAME "
      SelectStr1 = SelectStr1 & ",DI.REVENUE_ID,RT.REVENUE_NO,RT.REVENUE_NAME "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (BD.ACCEPT_BY = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE_NAME EN ON (EN.EMP_ID = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME ENM ON (ENM.NAME_ID = EN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
'      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
      
      
     ElseIf Ind = 36 Then      'CReportInventory060        'หาค่าเฉลี่ยใน Function    queryForAverageOfAge
      'SelectStr1 = "SELECT DI.PART_ITEM_ID, DI.PIG_AGE, DI.PIG_STATUS, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(EI.EXPORT_TOTAL_PRICE) EXPORT_TOTAL_PRICE, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = "SELECT DI.PART_ITEM_ID,DI.PIG_AGE,BD.DOCUMENT_DATE,  SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      'FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      If YEAR_SEQ_ID > 0 Or Len(WEEK_NO) > 0 Then
         FromStr = FromStr & "LEFT OUTER JOIN PRTITEM_MAP PM ON (PI.PART_ITEM_ID = PM.PART_ITEM_ID) "
         FromStr = FromStr & "LEFT OUTER JOIN YEAR_WEEK YW ON (YW.YEAR_WEEK_ID = PM.YEAR_WEEK_ID) "
         FromStr = FromStr & "LEFT OUTER JOIN YEAR_SEQ YQ ON (YQ.YEAR_SEQ_ID = YW.YEAR_SEQ_ID) "
      End If
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 37 Then
       SelectStr1 = "SELECT DISTINCT BD.BILLING_DOC_ID,PG.PART_GROUP_ID,PG.PART_GROUP_NAME  "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_GROUP PG ON (PT.PART_GROUP_ID = PG.PART_GROUP_ID ) "
   ElseIf Ind = 38 Then 'CReportSell011
      SelectStr1 = "SELECT DISTINCT BD.DOCUMENT_NO,BD.DOCUMENT_DATE,PT.PART_TYPE_NO,PT.PART_TYPE_NAME,PI.PIG_FLAG,PS.PRODUCT_STATUS_ID,PS.PRODUCT_STATUS_NO,Ps.PRODUCT_STATUS_NAME,SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO,RT.REVENUE_NAME "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
      'WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
      
      
   ElseIf Ind = 39 Then
      SelectStr1 = "SELECT DISTINCT BD.DOCUMENT_NO,BD.DOCUMENT_DATE,BD.YYYYMM,PT.PART_TYPE_NO,PT.PART_TYPE_NAME,PI.PIG_FLAG,PS.PRODUCT_STATUS_ID,PS.PRODUCT_STATUS_NO,Ps.PRODUCT_STATUS_NAME,SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT ,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT  "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
      
       ElseIf Ind = 40 Then
      SelectStr1 = "SELECT DISTINCT BD.YYYYMM   "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
     ElseIf Ind = 41 Then
      SelectStr1 = "SELECT DISTINCT PS.PRODUCT_STATUS_ID,PT.PART_TYPE_NO,  PT.PART_TYPE_NAME,PI.PIG_FLAG, PS.PRODUCT_STATUS_NO ,  PS.PRODUCT_STATUS_NAME   "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   
   ElseIf Ind = 42 Then 'CReportSell014
      SelectStr1 = "SELECT DISTINCT PS.PRODUCT_STATUS_NO ,  PS.PRODUCT_STATUS_NAME,PI.PIG_FLAG"
      SelectStr1 = SelectStr1 & ",PT.PART_TYPE_NO,  PT.PART_TYPE_NAME    "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO,RT.REVENUE_NAME "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
      'WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 43 Then 'GetProductStatusTypeYYYYMM
      SelectStr1 = "SELECT BD.YYYYMM,PT.PART_TYPE_NO,PI.PIG_FLAG,PS.PRODUCT_STATUS_NO "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO "
      SelectStr1 = SelectStr1 & ",SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT ,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT  "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      
      'WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 44 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME CUSTOMER_NAME"
      SelectStr1 = SelectStr1 & ",BD.DOCUMENT_NO,BD.DOCUMENT_DATE"
      SelectStr1 = SelectStr1 & ",PI.PART_NO,PI.PART_DESC "
      SelectStr1 = SelectStr1 & ",DI.ITEM_AMOUNT,DI.AVG_PRICE,DI.TOTAL_PRICE "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CN.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM1 ON (NM1.NAME_ID = CN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      
      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 45 Then 'CReportInventory030_2
      SelectStr1 = "SELECT DISTINCT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME CUSTOMER_NAME "
      SelectStr1 = SelectStr1 & ", DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CN.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM1 ON (NM1.NAME_ID = CN.NAME_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      
      WhereStr = "WHERE (PI.PIG_FLAG = 'Y') "
   ElseIf Ind = 46 Then 'GetPigStatusCustomerYYYYMM
      SelectStr1 = "SELECT DI.PIG_STATUS, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",CM.CUSTOMER_ID,BD.YYYYMM "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      
      WhereStr = "WHERE (PI.PIG_FLAG = 'Y') "
   ElseIf Ind = 47 Then 'CReportInventory062_3
      SelectStr1 = "SELECT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME CUSTOMER_NAME, DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, DI.* "
      SelectStr1 = SelectStr1 & ",RT.REVENUE_NO,RT.REVENUE_NAME,PT.PART_TYPE_NAME, EM.EMP_ID, EM.EMP_CODE, ENM.LONG_NAME "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CN.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM1 ON (NM1.NAME_ID = CN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      'FromStr = FromStr & "LEFT OUTER JOIN EXPORT_ITEM EI ON (EI.INVENTORY_DOC_ID = BD.INVENTORY_DOC_ID) AND (EI.LINK_ID = DI.LINK_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN STATUS_TYPE ST ON (PS.STATUS_TYPE = ST.STATUS_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (BD.ACCEPT_BY = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE_NAME EN ON (EN.EMP_ID = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME ENM ON (ENM.NAME_ID = EN.NAME_ID) "
   ElseIf Ind = 48 Then    'LoadDistinctPigAge
      SelectStr1 = "SELECT DISTINCT DI.PIG_AGE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 49 Then 'LoadSumWeightAmountByPigAge
      SelectStr1 = "SELECT DI.PIG_AGE,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (DI.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "

      WhereStr = "WHERE (DI.PART_ITEM_ID IS NOT NULL) "
      
   ElseIf Ind = 50 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME CUSTOMER_NAME, DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME "
      SelectStr1 = SelectStr1 & ",SUM(DI.TOTAL_PRICE) TOTAL_PRICE,SUM(DI.TOTAL_WEIGHT) TOTAL_WEIGHT,SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT,SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CN.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM1 ON (NM1.NAME_ID = CN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (DI.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN STATUS_TYPE ST ON (PS.STATUS_TYPE = ST.STATUS_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN REVENUE_TYPE RT ON (DI.REVENUE_ID = RT.REVENUE_TYPE_ID) "

   End If
   
   If DO_ITEM_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DO_ITEM_ID = " & DO_ITEM_ID & ") "
      Else
         WhereStr = WhereStr & "AND (DO_ITEM_ID = " & DO_ITEM_ID & ") "
      End If
   End If
   
   If DO_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DI.DO_ID = " & DO_ID & ") "
      Else
         WhereStr = WhereStr & "AND (DI.DO_ID = " & DO_ID & ") "
      End If
   End If
   
   If LOCATION_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (LOCATION_ID = " & LOCATION_ID & ") "
      Else
         WhereStr = WhereStr & "AND (LOCATION_ID = " & LOCATION_ID & ") "
      End If
   End If
   
   If BATCH_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (BATCH_ID = " & BATCH_ID & ") "
      Else
         WhereStr = WhereStr & "AND (BATCH_ID = " & BATCH_ID & ") "
      End If
   Else
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE ((BATCH_ID <= 0) OR (BATCH_ID IS NULL)) "
      Else
         WhereStr = WhereStr & "AND ((BATCH_ID <= 0) OR (BATCH_ID IS NULL)) "
      End If
   End If
   
   If SIMULATE_FLAG = "Y" Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (SIMULATE_FLAG = '" & SIMULATE_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (SIMULATE_FLAG = '" & SIMULATE_FLAG & "') "
      End If
   Else
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE ((SIMULATE_FLAG <> 'Y') OR (SIMULATE_FLAG IS NULL)) "
      Else
         WhereStr = WhereStr & "AND ((SIMULATE_FLAG <> 'Y') OR (SIMULATE_FLAG IS NULL)) "
      End If
   End If
   
   If Len(COMMIT_FLAG) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (COMMIT_FLAG = '" & COMMIT_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (COMMIT_FLAG = '" & COMMIT_FLAG & "') "
      End If
   End If
   
   If Len(TAKE_AWAY_FLAG) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (CM.TAKE_AWAY_FLAG = '" & TAKE_AWAY_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (CM.TAKE_AWAY_FLAG = '" & TAKE_AWAY_FLAG & "') "
      End If
   End If
   
   If Len(TAKE_KEY_ACCOUNT) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (CM.TAKE_KEY_ACCOUNT = '" & TAKE_KEY_ACCOUNT & "') "
      Else
         WhereStr = WhereStr & "AND (CM.TAKE_KEY_ACCOUNT = '" & TAKE_KEY_ACCOUNT & "') "
      End If
   End If
   
   If RevenueFlag = "Y" Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (REVENUE_ID IS NOT NULL) "
      Else
         WhereStr = WhereStr & "AND (REVENUE_ID IS NOT NULL) "
      End If
   End If
   
   If DOCUMENT_TYPE > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DOCUMENT_TYPE = " & DOCUMENT_TYPE & ") "
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_TYPE = " & DOCUMENT_TYPE & ") "
      End If
   End If
      
   If REVENUE_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (REVENUE_ID = " & REVENUE_ID & ") "
      Else
         WhereStr = WhereStr & "AND (REVENUE_ID = " & REVENUE_ID & ") "
      End If
   End If
   
   If RECEIPT_TYPE > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (RECEIPT_TYPE = " & RECEIPT_TYPE & ") "
      Else
         WhereStr = WhereStr & "AND (RECEIPT_TYPE = " & RECEIPT_TYPE & ") "
      End If
   End If
   
''   If Ind = 2 Then
'      If PART_TYPE > 0 Then
'         If Len(WhereStr) <= 0 Then
'            WhereStr = "WHERE (PART_TYPE = " & PART_TYPE & ") "
'         Else
'            WhereStr = WhereStr & "AND (PART_TYPE = " & PART_TYPE & ") "
'         End If
'      End If
'

      If Len(FROM_EMP_CODE) > 0 Then
         If Len(WhereStr) <= 0 Then
            WhereStr = "WHERE (EM.EMP_CODE >= '" & Trim(ChangeQuote(FROM_EMP_CODE)) & "') "
         Else
            WhereStr = WhereStr & "AND (EM.EMP_CODE >= '" & Trim(ChangeQuote(FROM_EMP_CODE)) & "') "
         End If
      End If
      
      If Len(TO_EMP_CODE) > 0 Then
         If Len(WhereStr) <= 0 Then
            WhereStr = "WHERE (EM.EMP_CODE <= '" & Trim(ChangeQuote(TO_EMP_CODE)) & "') "
         Else
            WhereStr = WhereStr & "AND (EM.EMP_CODE  <= '" & Trim(ChangeQuote(TO_EMP_CODE)) & "') "
         End If
      End If

       If FROM_DATE > -1 Then
         TempDate = DateToStringIntLow(Trim(FROM_DATE))
         If WhereStr = "" Then
            WhereStr = "WHERE (DOCUMENT_DATE >= '" & ChangeQuote(TempDate) & "')"
         Else
            WhereStr = WhereStr & "AND (DOCUMENT_DATE >= '" & ChangeQuote(TempDate) & "')"
         End If
      End If

      If TO_DATE > -1 Then
         TempDate = DateToStringIntHi(Trim(TO_DATE))
         If WhereStr = "" Then
            WhereStr = "WHERE (DOCUMENT_DATE <= '" & ChangeQuote(TempDate) & "')"
         Else
            WhereStr = WhereStr & "AND (DOCUMENT_DATE <= '" & ChangeQuote(TempDate) & "')"
         End If
      End If
      
    If VALID_DATE > -1 Then
      TempDate = DateToStringIntLow(Trim(VALID_DATE))
          If WhereStr = "" Then
              WhereStr = "WHERE ((VALID_DATE >= '" & ChangeQuote(TempDate) & "') OR (VALID_DATE IS NULL)) "
          Else
              WhereStr = WhereStr & "AND ((VALID_DATE >= '" & ChangeQuote(TempDate) & "') OR (VALID_DATE IS NULL)) "
          End If
      End If
   
   If Len(DocTypeSet) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DOCUMENT_TYPE IN " & DocTypeSet & ") "
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_TYPE IN " & DocTypeSet & ") "
      End If
   End If

   If Len(DocSubTypeSet) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DOCUMENT_SUBTYPE IN " & DocSubTypeSet & ") "
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_SUBTYPE IN " & DocSubTypeSet & ") "
      End If
   End If
   
'
'   If Trim(PART_NO) <> "" Then
'      If WildCard(PART_NO, SubLen, NewStr) Then
'         If WhereStr = "" Then
'            WhereStr = "WHERE (SUBSTR(PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
'         Else
'            WhereStr = WhereStr & "AND (SUBSTR(PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
'         End If
'      Else
'         If WhereStr = "" Then
'            WhereStr = "WHERE (PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
'         Else
'            WhereStr = WhereStr & "AND (PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
'         End If
'      End If
'   End If
   
   If CUSTOMER_TYPE > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (CUSTOMER_TYPE = " & CUSTOMER_TYPE & ") "
      Else
         WhereStr = WhereStr & "AND (CUSTOMER_TYPE = " & CUSTOMER_TYPE & ") "
      End If
   End If
   
   If PIG_STATUS > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DI.PIG_STATUS = " & PIG_STATUS & ") "
      Else
         WhereStr = WhereStr & "AND (DI.PIG_STATUS = " & PIG_STATUS & ") "
      End If
   End If
   
   If Len(PIG_FLAG) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (PIG_FLAG = '" & PIG_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (PIG_FLAG = '" & PIG_FLAG & "') "
      End If
   End If
   
   If Len(NON_SALE_FLAG) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (PS.NON_SALE_FLAG = '" & NON_SALE_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (PS.NON_SALE_FLAG = '" & NON_SALE_FLAG & "') "
      End If
   End If
   
   If Len(Trim(CUSTOMER_CODE)) > 0 Then
      If WildCard(CUSTOMER_CODE, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(CUSTOMER_CODE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(CUSTOMER_CODE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (CUSTOMER_CODE = '" & ChangeQuote(Trim(CUSTOMER_CODE)) & "')"
         Else
            WhereStr = WhereStr & "AND (CUSTOMER_CODE = '" & ChangeQuote(Trim(CUSTOMER_CODE)) & "')"
         End If
      End If
   End If
   
   If YEAR_SEQ_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (YW.YEAR_SEQ_ID = " & YEAR_SEQ_ID & ") "
      Else
         WhereStr = WhereStr & "AND (YW.YEAR_SEQ_ID = " & YEAR_SEQ_ID & ") "
      End If
   End If
   
   If Trim(WEEK_NO) <> "" Then
      If WildCard(WEEK_NO, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(WEEK_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(WEEK_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (WEEK_NO = '" & ChangeQuote(Trim(WEEK_NO)) & "')"
         Else
            WhereStr = WhereStr & "AND (WEEK_NO = '" & ChangeQuote(Trim(WEEK_NO)) & "')"
         End If
      End If
   End If
   
   If Len(Trim(PART_NO)) > 0 Then
      If WildCard(PART_NO, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(PI.PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(PI.PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (PI.PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
         Else
            WhereStr = WhereStr & "AND (PI.PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
         End If
      End If
   End If
   
   GroupByStr = ""
   If Ind = 2 Then
      GroupByStr = "GROUP BY BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE "
   ElseIf Ind = 3 Then
      GroupByStr = "GROUP BY BD.ACCOUNT_ID, BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE "
   ElseIf Ind = 5 Then
      GroupByStr = "GROUP BY DI.DO_ID "
   ElseIf Ind = 6 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID "
   ElseIf Ind = 7 Then
      GroupByStr = "GROUP BY DI.REVENUE_ID "
   ElseIf Ind = 8 Then
      GroupByStr = "GROUP BY BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE "
   ElseIf Ind = 10 Then
      GroupByStr = "GROUP BY EM.EMP_ID, CM.CUSTOMER_ID, DI.PART_ITEM_ID "
   ElseIf Ind = 12 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, DI.REVENUE_ID "
   ElseIf Ind = 13 Then
      GroupByStr = "GROUP BY DI.DO_ID, BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE "
   ElseIf Ind = 14 Then
      GroupByStr = "GROUP BY DI.DO_ID "
   ElseIf Ind = 15 Then
      GroupByStr = "GROUP BY DI.PART_ITEM_ID, DI.PIG_AGE, DI.PIG_STATUS "
   ElseIf Ind = 16 Then
      GroupByStr = "GROUP BY BD.YYYYMM "
   ElseIf Ind = 17 Then
      GroupByStr = "GROUP BY BD.YYYYMM "
   ElseIf Ind = 18 Then
      GroupByStr = "GROUP BY BD.YYYYMM2 "
   ElseIf Ind = 19 Then
      GroupByStr = "GROUP BY BD.YYYYMM2 "
   ElseIf Ind = 20 Then
      GroupByStr = "GROUP BY DI.PIG_STATUS, BD.YYYYMM "
   ElseIf Ind = 21 Then
      GroupByStr = "GROUP BY DI.REVENUE_ID, BD.YYYYMM "
   ElseIf Ind = 25 Then
      GroupByStr = "GROUP BY DI.PART_ITEM_ID , DI.PIG_STATUS, BD.YYYYMM "
   ElseIf Ind = 26 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME , DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME,RT.REVENUE_NO,RT.REVENUE_NAME,PT.PART_TYPE_NAME, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, BD.CREATE_DATE "
   ElseIf Ind = 27 Then
      GroupByStr = "GROUP BY PI.PART_NO, PI.PIG_TYPE, PS.PRODUCT_STATUS_NO,DI.PIG_AGE,BD.DOCUMENT_DATE,RT.REVENUE_NO "
   ElseIf Ind = 29 Then
      GroupByStr = "GROUP BY PS.PRODUCT_STATUS_NAME "
   ElseIf Ind = 30 Then
      GroupByStr = "GROUP BY PS.PRODUCT_STATUS_NAME,PI.PART_NO,PI.PIG_TYPE "
    
'   ElseIf Ind = 31 Then
'      GroupByStr = "GROUP BY DI.PIG_AGE , DI.TOTAL_WEIGHT "
   ElseIf Ind = 33 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID "
   ElseIf Ind = 36 Then
      GroupByStr = "GROUP BY DI.PART_ITEM_ID,DOCUMENT_DATE  , DI.PIG_AGE, DI.PIG_STATUS  "
   ElseIf Ind = 38 Then
      GroupByStr = "GROUP BY BD.DOCUMENT_NO,BD.DOCUMENT_DATE,PT.PART_TYPE_NO,PT.PART_TYPE_NAME,PI.PIG_FLAG,PS.PRODUCT_STATUS_ID,PS.PRODUCT_STATUS_NO,PS.PRODUCT_STATUS_NAME,RT.REVENUE_NO,RT.REVENUE_NAME  "
  ElseIf Ind = 39 Then
      GroupByStr = "GROUP BY BD.DOCUMENT_NO,BD.DOCUMENT_DATE,BD.YYYYMM,PT.PART_TYPE_NO,PT.PART_TYPE_NAME,PI.PIG_FLAG,PS.PRODUCT_STATUS_ID,PS.PRODUCT_STATUS_NO,PS.PRODUCT_STATUS_NAME  "
   ElseIf Ind = 40 Then
      GroupByStr = "GROUP BY BD.DOCUMENT_NO,BD.DOCUMENT_DATE,BD.YYYYMM,PT.PART_TYPE_NO,PT.PART_TYPE_NAME,PI.PIG_FLAG,PS.PRODUCT_STATUS_ID,PS.PRODUCT_STATUS_NO,PS.PRODUCT_STATUS_NAME  "
  ElseIf Ind = 41 Then
      GroupByStr = "GROUP  BY BD.DOCUMENT_NO,BD.DOCUMENT_DATE,BD.YYYYMM,PT.PART_TYPE_NO,PT.PART_TYPE_NAME,PI.PIG_FLAG,PS.PRODUCT_STATUS_ID,PS.PRODUCT_STATUS_NO,PS.PRODUCT_STATUS_NAME  "
   ElseIf Ind = 43 Then
      GroupByStr = "GROUP  BY BD.YYYYMM,PT.PART_TYPE_NO,PI.PIG_FLAG,PS.PRODUCT_STATUS_NO,RT.REVENUE_NO  "
   ElseIf Ind = 46 Then
      GroupByStr = "GROUP  BY DI.PIG_STATUS,CM.CUSTOMER_ID,BD.YYYYMM  "
   ElseIf Ind = 49 Then
      GroupByStr = "GROUP  BY DI.PIG_AGE "
   ElseIf Ind = 50 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM1.LONG_NAME , DI.PIG_STATUS, PS.PRODUCT_STATUS_NAME "
   End If
      
   OrderByStr = ""
   OrderTypeStr = ""

   If Ind = 1 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY DO_ITEM_ID "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY DO_ITEM_ID "
      ElseIf OrderBy = 3 Then
         OrderByStr = "ORDER BY DOCUMENT_DATE DESC, TRANSACTION_SEQ "
      ElseIf OrderBy = 4 Then
         OrderByStr = "ORDER BY LOCATION_ID DESC, DOCUMENT_DATE DESC, TRANSACTION_SEQ "
      ElseIf OrderBy = 5 Then
         OrderByStr = "ORDER BY PT.PART_TYPE_NO "
      ElseIf OrderBy = 6 Then
         OrderByStr = "ORDER BY PI.PART_NO "
      ElseIf OrderBy = 7 Then
         OrderByStr = "ORDER BY IVD.DOCUMENT_DATE "
      ElseIf OrderBy = 8 Then
         OrderByStr = "ORDER BY IVD.DOCUMENT_NO "
      ElseIf OrderBy = 9 Then
         OrderByStr = "ORDER BY LC.LOCATION_NO "
      ElseIf OrderBy = 10 Then
         OrderByStr = "ORDER BY IVD.DOCUMENT_DATE ASC, RT.REVENUE_NO "
      ElseIf OrderBy = 11 Then
         OrderByStr = "ORDER BY  RT.REVENUE_NO ASC, IVD.DOCUMENT_DATE "
      Else
         OrderByStr = "ORDER BY DO_ITEM_ID "
      End If
   ElseIf Ind = 2 Then
      'OrderByStr = "ORDER BY DO_ITEM_ID "
   ElseIf Ind = 3 Then
      'OrderByStr = "ORDER BY DO_ITEM_ID "
   ElseIf Ind = 4 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY DOCUMENT_DATE ASC, DOCUMENT_NO "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY DOCUMENT_NO ASC, DOCUMENT_DATE "
      Else
         OrderByStr = "ORDER BY DOCUMENT_DATE ASC, DOCUMENT_NO "
      End If
   ElseIf Ind = 5 Then
      OrderByStr = "ORDER BY DI.DO_ID "
   ElseIf Ind = 6 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_ID "
   ElseIf Ind = 7 Then
      OrderByStr = "ORDER BY DI.REVENUE_ID "
   ElseIf Ind = 8 Then
      'OrderByStr = "ORDER BY DO_ITEM_ID "
   ElseIf Ind = 9 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY CSTTYPE_NAME ASC, CUSTOMER_CODE "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY EMP_CODE ASC, CSTTYPE_NAME ASC, CUSTOMER_CODE ASC, PART_ITEM_ID "
      ElseIf OrderBy = 3 Then
         OrderByStr = "ORDER BY EMP_CODE ASC , CSTTYPE_NAME ASC, PIG_FLAG ASC , PART_TYPE_NAME ASC, PART_ITEM_ID ASC, CUSTOMER_CODE "
      Else
         OrderByStr = "ORDER BY CSTTYPE_NAME ASC, CUSTOMER_CODE "
      End If
   ElseIf Ind = 10 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_ID "
   ElseIf Ind = 11 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_ID "
   ElseIf Ind = 12 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_ID "
   ElseIf Ind = 13 Then
      'OrderByStr = "ORDER BY DO_ID "
   ElseIf Ind = 14 Then
      'OrderByStr = "ORDER BY DO_ID "
   ElseIf Ind = 15 Then
      OrderByStr = "ORDER BY DI.PIG_AGE,DI.PART_ITEM_ID , DI.PIG_STATUS "
   ElseIf Ind = 16 Then
      OrderByStr = "ORDER BY BD.YYYYMM "
   ElseIf Ind = 17 Then
      OrderByStr = "ORDER BY BD.YYYYMM "
   ElseIf Ind = 18 Then
      OrderByStr = "ORDER BY BD.YYYYMM2 "
   ElseIf Ind = 19 Then
      OrderByStr = "ORDER BY BD.YYYYMM2 "
   ElseIf Ind = 20 Then
      OrderByStr = "ORDER BY DI.PIG_STATUS, BD.YYYYMM "
   ElseIf Ind = 21 Then
      OrderByStr = "ORDER BY DI.REVENUE_ID, BD.YYYYMM "
   ElseIf Ind = 22 Then
      OrderByStr = "ORDER BY ST.STATUS_TYPE_NO ASC, PS.PRODUCT_STATUS_NO "
   ElseIf Ind = 23 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, PS.PRODUCT_STATUS_NAME ASC,RT.REVENUE_NO ASC,PT.PART_TYPE_NAME ASC, BD.DOCUMENT_DATE ASC, BD.DOCUMENT_NO "
   ElseIf Ind = 24 Then
      OrderByStr = "ORDER BY PS.PRODUCT_STATUS_NO ASC, PI.PART_NO ASC, PI.PIG_TYPE ASC, PI.PART_DESC "
   ElseIf Ind = 26 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, PS.PRODUCT_STATUS_NAME ASC,RT.REVENUE_NO ASC,PT.PART_TYPE_NAME, BD.DOCUMENT_DATE ASC, BD.DOCUMENT_NO "
   ElseIf Ind = 27 Then
      OrderByStr = "ORDER BY BD.DOCUMENT_DATE,PI.PART_NO, PI.PIG_TYPE, PS.PRODUCT_STATUS_NO,DI.PIG_AGE,RT.REVENUE_NO "
   ElseIf Ind = 28 Then
      OrderByStr = "ORDER BY BD.DOCUMENT_DATE "
   ElseIf Ind = 29 Then
      OrderByStr = "ORDER BY PS.PRODUCT_STATUS_NAME "
   ElseIf Ind = 30 Then
      OrderByStr = "ORDER BY PS.PRODUCT_STATUS_NAME,PI.PART_NO "
   ElseIf Ind = 34 Then
      OrderByStr = "ORDER BY  RT.REVENUE_NO ASC, IVD.DOCUMENT_DATE "
   ElseIf Ind = 35 Then
      OrderByStr = "ORDER BY EMP_CODE ASC , CSTTYPE_NAME ASC, PIG_FLAG ASC , PART_TYPE_NAME ASC, PRODUCT_STATUS_NO ASC, PART_ITEM_ID ASC,RT.REVENUE_NO ASC, CUSTOMER_CODE "
   ElseIf Ind = 36 Then
      OrderByStr = "ORDER BY DI.PIG_AGE,DI.PART_ITEM_ID , DI.PIG_STATUS "
   ElseIf Ind = 37 Then
      OrderByStr = "ORDER BY BD.BILLING_DOC_ID ASC,PG.PART_GROUP_ID "
   ElseIf Ind = 38 Then
      OrderByStr = "ORDER BY PIG_FLAG DESC,PRODUCT_STATUS_NO ASC,PART_TYPE_NAME ASC,RT.REVENUE_NO "
    ElseIf Ind = 39 Then
      OrderByStr = "ORDER BY PIG_FLAG DESC,PRODUCT_STATUS_NO ASC,PART_TYPE_NAME   ASC,BD.DOCUMENT_DATE     "
   
    ElseIf Ind = 40 Then
      OrderByStr = "ORDER BY PIG_FLAG DESC,PRODUCT_STATUS_NO ASC,PART_TYPE_NAME   ASC,BD.DOCUMENT_DATE     "
   ElseIf Ind = 41 Then
      OrderByStr = "ORDER BY PIG_FLAG DESC,PRODUCT_STATUS_NO ASC,PART_TYPE_NAME   ASC,BD.DOCUMENT_DATE     "
    ElseIf Ind = 42 Then
      OrderByStr = "ORDER BY PIG_FLAG DESC,PRODUCT_STATUS_NO ASC,PART_TYPE_NAME ASC,RT.REVENUE_NO    "
   ElseIf Ind = 44 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC,BD.DOCUMENT_DATE ASC,BD.DOCUMENT_NO ASC,PI.PART_NO  "
      OrderType = 1
   ElseIf Ind = 45 Then
      OrderByStr = "ORDER BY PS.PRODUCT_STATUS_NO ASC,CM.CUSTOMER_CODE "
      OrderType = 1
   ElseIf Ind = 47 Then
      OrderByStr = "ORDER BY EM.EMP_CODE ASC,CM.CUSTOMER_CODE ASC, PS.PRODUCT_STATUS_NAME ASC,RT.REVENUE_NO ASC,PT.PART_TYPE_NAME ASC, BD.DOCUMENT_DATE ASC, BD.DOCUMENT_NO "
   ElseIf Ind = 48 Then
      OrderByStr = "ORDER BY DI.PIG_AGE "
      OrderType = 1
   ElseIf Ind = 50 Then
      OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, PS.PRODUCT_STATUS_NAME "
   End If
   
   If OrderType = 1 Then
      OrderTypeStr = "ASC "
   ElseIf OrderType = 2 Then
      OrderTypeStr = "DESC "
   Else
      OrderTypeStr = "ASC "
   End If
   
   If OrderByStr = "" Then
      OrderTypeStr = ""
   End If
   
   SQL1 = SelectStr1 & FromStr & WhereStr & GroupByStr & OrderByStr & OrderTypeStr
   SQL2 = SelectStr2 & FromStr & WhereStr
 '  ''debug.print SQL1
   Call glbDatabaseMngr.GetRs(SQL1, SQL2, True, itemcount, Rs, glbErrorLog)
End Function
Public Function PopulateFromRS(Ind As Long, Rs As ADODB.Recordset)
   If Ind = 1 Then
      DO_ITEM_ID = NVLI(Rs("DO_ITEM_ID"), -1)
      DO_ID = NVLI(Rs("DO_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      LOCATION_ID = NVLI(Rs("LOCATION_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      AVG_WEIGHT = NVLD(Rs("AVG_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      GUI_ID = NVLI(Rs("GUI_ID"), -1)
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)
      LINK_ID = NVLI(Rs("LINK_ID"), -1)
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), -1)
      PIG_AGE = NVLI(Rs("PIG_AGE"), 0)
      AGE_CODE = NVLS(Rs("AGE_CODE"), "")
      PEDIGREE_COST = NVLD(Rs("PEDIGREE_COST"), 0)
      
      DISCOUNT_PERCENT = NVLD(Rs("DISCOUNT_PERCENT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      DISCOUNT_REASON = NVLS(Rs("DISCOUNT_REASON"), "")
      
      SHOW_AVG = NVLS(Rs("SHOW_AVG"), "")
      
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      COMMIT_FLAG = NVLS(Rs("COMMIT_FLAG"), "")
      PIG_TYPE = NVLS(Rs("PIG_TYPE"), "")
      PART_NO = NVLS(Rs("PART_NO"), "")
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PIG_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      LOCATION_NAME = NVLS(Rs("LOCATION_NAME"), "")
      LOCATION_NO = NVLS(Rs("LOCATION_NO"), "")
      LOCATION_TYPE = NVLI(Rs("LOCATION_TYPE"), -1)
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      PART_TYPE = NVLI(Rs("PART_TYPE"), -1)
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      
      PKG_TYPE = NVLI(Rs("PKG_TYPE"), -1)
      UNIT_NAME = NVLS(Rs("UNIT_NAME"), "")
   ElseIf Ind = 2 Then
      DOCUMENT_TYPE = NVLI(Rs("DOCUMENT_TYPE"), 0)
      DOCUMENT_SUBTYPE = NVLI(Rs("DOCUMENT_SUBTYPE"), 0)
      RECEIPT_TYPE = NVLI(Rs("RECEIPT_TYPE"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
   ElseIf Ind = 3 Then
      ACCOUNT_ID = NVLI(Rs("ACCOUNT_ID"), 0)
      DOCUMENT_TYPE = NVLI(Rs("DOCUMENT_TYPE"), 0)
      DOCUMENT_SUBTYPE = NVLI(Rs("DOCUMENT_SUBTYPE"), 0)
      RECEIPT_TYPE = NVLI(Rs("RECEIPT_TYPE"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 4 Then
      DO_ID = NVLI(Rs("DO_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
   ElseIf Ind = 5 Then
      DO_ID = NVLI(Rs("DO_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
   ElseIf Ind = 6 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
   ElseIf Ind = 7 Then
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 8 Then
      DOCUMENT_TYPE = NVLI(Rs("DOCUMENT_TYPE"), 0)
      DOCUMENT_SUBTYPE = NVLI(Rs("DOCUMENT_SUBTYPE"), 0)
      RECEIPT_TYPE = NVLI(Rs("RECEIPT_TYPE"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 9 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      EMP_ID = NVLI(Rs("EMP_ID"), 0)
      EMP_CODE = NVLS(Rs("EMP_CODE"), "")
      EMP_LONGNAME = NVLS(Rs("LONG_NAME"), "")
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
   ElseIf Ind = 10 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      EXPORT_TOTAL_PRICE = NVLD(Rs("EXPORT_TOTAL_PRICE"), 0)
      EMP_ID = NVLI(Rs("EMP_ID"), 0)
   ElseIf Ind = 11 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), 0)
   ElseIf Ind = 12 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 13 Then
      DO_ID = NVLI(Rs("DO_ID"), -1)
      DOCUMENT_TYPE = NVLI(Rs("DOCUMENT_TYPE"), 0)
      DOCUMENT_SUBTYPE = NVLI(Rs("DOCUMENT_SUBTYPE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
   ElseIf Ind = 14 Then
      DO_ID = NVLI(Rs("DO_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 15 Then
      PIG_AGE = NVLD(Rs("PIG_AGE"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      'EXPORT_TOTAL_PRICE = NVLD(Rs("EXPORT_TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      
   ElseIf Ind = 16 Then
      YYYYMM = NVLS(Rs("YYYYMM"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      
      BFOOD_AMOUNT = NVLD(Rs("BFOOD_AMOUNT"), 0)
      BMEDICINE_AMOUNT = NVLD(Rs("BMEDICINE_AMOUNT"), 0)
      BEXPENSE_AMOUNT = NVLD(Rs("BEXPENSE_AMOUNT"), 0)
      BIRTH_AMOUNT = NVLD(Rs("BIRTH_AMOUNT"), 0)
      BBIRTH_AMOUNT = NVLD(Rs("BBIRTH_AMOUNT"), 0)
      FOOD_AMOUNT = NVLD(Rs("FOOD_AMOUNT"), 0)
      MEDICINE_AMOUNT = NVLD(Rs("MEDICINE_AMOUNT"), 0)
      OTHER_AMOUNT = NVLD(Rs("OTHER_AMOUNT"), 0)
      EXPENSE_AMOUNT = NVLD(Rs("EXPENSE_AMOUNT"), 0)
      
   ElseIf Ind = 17 Then
      YYYYMM = NVLS(Rs("YYYYMM"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 18 Then
      YYYYMM2 = NVLS(Rs("YYYYMM2"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 19 Then
      YYYYMM2 = NVLS(Rs("YYYYMM2"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 20 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      YYYYMM = NVLS(Rs("YYYYMM"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 21 Then
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), 0)
      YYYYMM = NVLS(Rs("YYYYMM"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 22 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PIG_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PRDTYP_GRP_NAME = NVLS(Rs("PRDTYP_GRP_NAME"), "")
      PRDTYP_GRP_NO = NVLS(Rs("PRDTYP_GRP_NO"), "")
   ElseIf Ind = 23 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
   ElseIf Ind = 24 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PIG_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      PIG_TYPE = NVLS(Rs("PIG_TYPE"), "")
   ElseIf Ind = 25 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      YYYYMM = NVLS(Rs("YYYYMM"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 26 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      
      CREATE_DATE = InternalDateToDate(NVLS(Rs("CREATE_DATE"), ""))
   ElseIf Ind = 27 Then
      PART_NO = NVLS(Rs("PART_NO"), "")
      PIG_TYPE = NVLS(Rs("PIG_TYPE"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PIG_AGE = NVLD(Rs("PIG_AGE"), 0)
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      EXPORT_TOTAL_PRICE = NVLD(Rs("EXPORT_TOTAL_PRICE"), 0)
   ElseIf Ind = 28 Then
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
      BFOOD_AMOUNT = NVLD(Rs("BFOOD_AMOUNT"), 0)
      BMEDICINE_AMOUNT = NVLD(Rs("BMEDICINE_AMOUNT"), 0)
      BEXPENSE_AMOUNT = NVLD(Rs("BEXPENSE_AMOUNT"), 0)
      BIRTH_AMOUNT = NVLD(Rs("BIRTH_AMOUNT"), 0)
      BBIRTH_AMOUNT = NVLD(Rs("BBIRTH_AMOUNT"), 0)
      FOOD_AMOUNT = NVLD(Rs("FOOD_AMOUNT"), 0)
      MEDICINE_AMOUNT = NVLD(Rs("MEDICINE_AMOUNT"), 0)
      OTHER_AMOUNT = NVLD(Rs("OTHER_AMOUNT"), 0)
      EXPENSE_AMOUNT = NVLD(Rs("EXPENSE_AMOUNT"), 0)
   ElseIf Ind = 29 Then
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
      BFOOD_AMOUNT = NVLD(Rs("BFOOD_AMOUNT"), 0)
      BMEDICINE_AMOUNT = NVLD(Rs("BMEDICINE_AMOUNT"), 0)
      BEXPENSE_AMOUNT = NVLD(Rs("BEXPENSE_AMOUNT"), 0)
      BIRTH_AMOUNT = NVLD(Rs("BIRTH_AMOUNT"), 0)
      BBIRTH_AMOUNT = NVLD(Rs("BBIRTH_AMOUNT"), 0)
      FOOD_AMOUNT = NVLD(Rs("FOOD_AMOUNT"), 0)
      MEDICINE_AMOUNT = NVLD(Rs("MEDICINE_AMOUNT"), 0)
      OTHER_AMOUNT = NVLD(Rs("OTHER_AMOUNT"), 0)
      EXPENSE_AMOUNT = NVLD(Rs("EXPENSE_AMOUNT"), 0)
   ElseIf Ind = 30 Then
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PART_NO = NVLS(Rs("PART_NO"), "")
      PIG_TYPE = NVLS(Rs("PIG_TYPE"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
      BFOOD_AMOUNT = NVLD(Rs("BFOOD_AMOUNT"), 0)
      BMEDICINE_AMOUNT = NVLD(Rs("BMEDICINE_AMOUNT"), 0)
      BEXPENSE_AMOUNT = NVLD(Rs("BEXPENSE_AMOUNT"), 0)
      BIRTH_AMOUNT = NVLD(Rs("BIRTH_AMOUNT"), 0)
      BBIRTH_AMOUNT = NVLD(Rs("BBIRTH_AMOUNT"), 0)
      FOOD_AMOUNT = NVLD(Rs("FOOD_AMOUNT"), 0)
      MEDICINE_AMOUNT = NVLD(Rs("MEDICINE_AMOUNT"), 0)
      OTHER_AMOUNT = NVLD(Rs("OTHER_AMOUNT"), 0)
      EXPENSE_AMOUNT = NVLD(Rs("EXPENSE_AMOUNT"), 0)
   ElseIf Ind = 31 Then
      PIG_AGE = NVLD(Rs("PIG_AGE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
    ElseIf Ind = 32 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 33 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 34 Then
      DO_ITEM_ID = NVLI(Rs("DO_ITEM_ID"), -1)
      DO_ID = NVLI(Rs("DO_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      LOCATION_ID = NVLI(Rs("LOCATION_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      AVG_WEIGHT = NVLD(Rs("AVG_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      GUI_ID = NVLI(Rs("GUI_ID"), -1)
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)
      LINK_ID = NVLI(Rs("LINK_ID"), -1)
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), -1)
      PIG_AGE = NVLI(Rs("PIG_AGE"), 0)
      AGE_CODE = NVLS(Rs("AGE_CODE"), "")
      PEDIGREE_COST = NVLD(Rs("PEDIGREE_COST"), 0)
      
      DISCOUNT_PERCENT = NVLD(Rs("DISCOUNT_PERCENT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      DISCOUNT_REASON = NVLS(Rs("DISCOUNT_REASON"), "")
      
      SHOW_AVG = NVLS(Rs("SHOW_AVG"), "")
      
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      COMMIT_FLAG = NVLS(Rs("COMMIT_FLAG"), "")
      PIG_TYPE = NVLS(Rs("PIG_TYPE"), "")
      PART_NO = NVLS(Rs("PART_NO"), "")
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PIG_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      LOCATION_NAME = NVLS(Rs("LOCATION_NAME"), "")
      LOCATION_NO = NVLS(Rs("LOCATION_NO"), "")
      LOCATION_TYPE = NVLI(Rs("LOCATION_TYPE"), -1)
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      PART_TYPE = NVLI(Rs("PART_TYPE"), -1)
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      
      PKG_TYPE = NVLI(Rs("PKG_TYPE"), -1)
      
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
   ElseIf Ind = 35 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      EMP_ID = NVLI(Rs("EMP_ID"), 0)
      EMP_CODE = NVLS(Rs("EMP_CODE"), "")
      EMP_LONGNAME = NVLS(Rs("LONG_NAME"), "")
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PRODUCT_STATUS_ID = NVLI(Rs("PRODUCT_STATUS_ID"), 0)
      
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      REVENUE_ID = NVLI(Rs("REVENUE_ID"), 0)
   ElseIf Ind = 36 Then
      'PIG_AGE = NVLD(Rs("PIG_AGE"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      'PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      'EXPORT_TOTAL_PRICE = NVLD(Rs("EXPORT_TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
   ElseIf Ind = 37 Then
      DO_ID = NVLI(Rs("BILLING_DOC_ID"), 0)
      PART_GROUP_ID = NVLI(Rs("PART_GROUP_ID"), 0)
      PART_GROUP_NAME = NVLS(Rs("PART_GROUP_NAME"), "")
   ElseIf Ind = 38 Then
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      
      PART_TYPE_NO = NVLS(Rs("PART_TYPE_NO"), "")
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PRODUCT_STATUS_ID = NVLI(Rs("PRODUCT_STATUS_ID"), 0)
      
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
       ElseIf Ind = 39 Then
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      
      PART_TYPE_NO = NVLS(Rs("PART_TYPE_NO"), "")
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PRODUCT_STATUS_ID = NVLI(Rs("PRODUCT_STATUS_ID"), 0)
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      YYYYMM = NVLS(Rs("YYYYMM"), "")
      
    ElseIf Ind = 40 Then
 
      YYYYMM = NVLS(Rs("YYYYMM"), "")
   ElseIf Ind = 41 Then
      PART_TYPE_NO = NVLS(Rs("PART_TYPE_NO"), "")
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      PRODUCT_STATUS_ID = NVLI(Rs("PRODUCT_STATUS_ID"), 0)
   
   ElseIf Ind = 42 Then
      PART_TYPE_NO = NVLS(Rs("PART_TYPE_NO"), "")
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
   ElseIf Ind = 43 Then
      PART_TYPE_NO = NVLS(Rs("PART_TYPE_NO"), "")
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      PIG_FLAG = NVLS(Rs("PIG_FLAG"), "")
      PRODUCT_STATUS_NO = NVLS(Rs("PRODUCT_STATUS_NO"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      YYYYMM = NVLS(Rs("YYYYMM"), "")
   ElseIf Ind = 44 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 45 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)
      PRODUCT_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
   ElseIf Ind = 46 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      
      YYYYMM = NVLS(Rs("YYYYMM"), "")
   ElseIf Ind = 47 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      
      REVENUE_NO = NVLS(Rs("REVENUE_NO"), "")
      REVENUE_NAME = NVLS(Rs("REVENUE_NAME"), "")
      
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      
      EMP_ID = NVLI(Rs("EMP_ID"), -1)
      EMP_CODE = NVLS(Rs("EMP_CODE"), "")
      EMP_LONGNAME = NVLS(Rs("LONG_NAME"), "")
   ElseIf Ind = 48 Then
      PIG_AGE = NVLI(Rs("PIG_AGE"), 0)
   ElseIf Ind = 49 Then
      PIG_AGE = NVLI(Rs("PIG_AGE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 50 Then
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), 0)
      PIG_STATUS_NAME = NVLS(Rs("PRODUCT_STATUS_NAME"), "")
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
   End If
End Function

Public Function AddEditData()
Dim ServerDateTime As String
Dim SQL1 As String
Dim ID As Long
Dim ID2 As Long
Dim TempID1 As String
Dim TempID2 As String
Dim TempID3 As String
Dim TempID4 As String
Dim TempID5 As String

   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   TempID1 = PIG_STATUS
   If PIG_STATUS <= 0 Then
      TempID1 = "NULL"
   End If
   
   TempID2 = PART_ITEM_ID
   If PART_ITEM_ID <= 0 Then
      TempID2 = "NULL"
   End If
   
   TempID3 = LOCATION_ID
   If LOCATION_ID <= 0 Then
      TempID3 = "NULL"
   End If
   
   TempID4 = REVENUE_ID
   If REVENUE_ID <= 0 Then
      TempID4 = "NULL"
   End If
   
   TempID5 = PKG_TYPE
   If PKG_TYPE <= 0 Then
      TempID5 = "NULL"
   End If
   
   If SHOW_AVG = "" Then
      SHOW_AVG = "N"
   End If
   
   If AddEditMode = SHOW_ADD Then
      Call glbDatabaseMngr.GetSeqID("DO_ITEM_SEQ", ID, glbErrorLog)
      
      SQL1 = "INSERT INTO DO_ITEM " & _
                     "( " & _
                     "   DO_ITEM_ID, " & _
                     "   DO_ID, " & _
                     "   PART_ITEM_ID, " & _
                     "   LOCATION_ID, " & _
                     "   ITEM_AMOUNT, " & _
                     "   TOTAL_WEIGHT, " & _
                     "   AVG_WEIGHT, " & _
                     "   TOTAL_PRICE, " & _
                     "   AVG_PRICE, "
            SQL1 = SQL1 & _
                     "   GUI_ID, " & _
                     "   LINK_ID, " & _
                     "   PIG_STATUS, " & _
                     "   REVENUE_ID, "
            SQL1 = SQL1 & _
                     "   PIG_AGE, " & _
                     "   AGE_CODE, " & _
                     "   PKG_TYPE, " & _
                     "   PEDIGREE_COST, " & _
                     "   DISCOUNT_PERCENT, " & _
                     "   DISCOUNT_AMOUNT, " & _
                     "   DISCOUNT_REASON, "
         SQL1 = SQL1 & _
                     "   SHOW_AVG, " & _
                     "   BFOOD_AMOUNT, " & _
                     "   BMEDICINE_AMOUNT, " & _
                     "   BEXPENSE_AMOUNT, " & _
                     "   BIRTH_AMOUNT, " & _
                     "   BBIRTH_AMOUNT, " & _
                     "   FOOD_AMOUNT, " & _
                     "   MEDICINE_AMOUNT, " & _
                     "   OTHER_AMOUNT, " & _
                     "   EXPENSE_AMOUNT, "
            SQL1 = SQL1 & _
                     "   CREATE_DATE, " & _
                    "    CREATE_BY, " & _
                    "    MODIFY_DATE, " & _
                    "    MODIFY_BY " & _
                     ") " & _
                     "VALUES " & _
                     "( " & _
                         ID & "," & _
                         "" & DO_ID & "," & _
                         "" & TempID2 & "," & _
                         "" & TempID3 & "," & _
                         "" & ITEM_AMOUNT & "," & _
                         "" & TOTAL_WEIGHT & "," & _
                         "" & AVG_WEIGHT & "," & _
                         "" & TOTAL_PRICE & "," & _
                         "" & AVG_PRICE & "," & _
                         "" & GUI_ID & "," & _
                         "" & LINK_ID & "," & _
                         "" & TempID1 & ","
            SQL1 = SQL1 & _
                        "" & TempID4 & "," & _
                        "" & PIG_AGE & "," & _
                        "'" & Trim(ChangeQuote(AGE_CODE)) & "'," & _
                        "" & TempID5 & "," & _
                        "" & PEDIGREE_COST & "," & _
                        "" & DISCOUNT_PERCENT & "," & _
                        "" & DISCOUNT_AMOUNT & "," & _
                        "'" & Trim(ChangeQuote(DISCOUNT_REASON)) & "'," & _
                        "'" & Trim(ChangeQuote(SHOW_AVG)) & "'," & _
                        "" & BFOOD_AMOUNT & "," & _
                        "" & BMEDICINE_AMOUNT & "," & _
                        "" & BEXPENSE_AMOUNT & "," & _
                        "" & BIRTH_AMOUNT & "," & _
                        "" & BBIRTH_AMOUNT & "," & _
                        "" & FOOD_AMOUNT & "," & _
                        "" & MEDICINE_AMOUNT & "," & _
                        "" & OTHER_AMOUNT & "," & _
                        "" & EXPENSE_AMOUNT & "," & _
                         "'" & ServerDateTime & "'," & _
                         glbUser.USER_ID & "," & _
                         "'" & ServerDateTime & "'," & _
                         glbUser.USER_ID & _
                     ") "
         DO_ITEM_ID = ID
   Else 'Show edit
      Call glbDatabaseMngr.GetSeqID("TRANSACTION_SEQUENCE_SEQ", ID2, glbErrorLog)
      
      SQL1 = "UPDATE DO_ITEM SET " & _
                     "   DO_ID = " & DO_ID & ", " & _
                     "   PART_ITEM_ID = " & TempID2 & ", " & _
                     "   LOCATION_ID = " & TempID3 & ", " & _
                     "   ITEM_AMOUNT = " & ITEM_AMOUNT & ", " & _
                     "   TOTAL_WEIGHT = " & TOTAL_WEIGHT & ", " & _
                     "   AVG_WEIGHT = " & AVG_WEIGHT & ", " & _
                     "   TOTAL_PRICE = " & TOTAL_PRICE & ", " & _
                     "   AVG_PRICE = " & AVG_PRICE & ", " & _
                     "   GUI_ID = " & GUI_ID & ", " & _
                     "   LINK_ID = " & LINK_ID & ", " & _
                     "   PIG_STATUS = " & TempID1 & ", " & _
                     "   REVENUE_ID = " & TempID4 & ", " & _
                     "   PIG_AGE = " & PIG_AGE & ", " & _
                     "   AGE_CODE = '" & Trim(ChangeQuote(AGE_CODE)) & "', " & _
                     "   PKG_TYPE = " & TempID5 & ", " & _
                     "   PEDIGREE_COST = " & PEDIGREE_COST & ", " & _
                     "   DISCOUNT_PERCENT = " & DISCOUNT_PERCENT & ", " & _
                     "   DISCOUNT_AMOUNT = " & DISCOUNT_AMOUNT & ", "
               SQL1 = SQL1 & _
                     "   DISCOUNT_REASON = '" & Trim(ChangeQuote(DISCOUNT_REASON)) & "', " & _
                     "   SHOW_AVG = '" & Trim(ChangeQuote(SHOW_AVG)) & "', " & _
                     "   BFOOD_AMOUNT = " & BFOOD_AMOUNT & ", " & _
                     "   BMEDICINE_AMOUNT = " & BMEDICINE_AMOUNT & ", " & _
                     "   BEXPENSE_AMOUNT = " & BEXPENSE_AMOUNT & ", " & _
                     "   BIRTH_AMOUNT = " & BIRTH_AMOUNT & ", " & _
                     "   BBIRTH_AMOUNT = " & BBIRTH_AMOUNT & ", " & _
                     "   FOOD_AMOUNT = " & FOOD_AMOUNT & ", " & _
                     "   MEDICINE_AMOUNT = " & MEDICINE_AMOUNT & ", " & _
                     "   OTHER_AMOUNT = " & OTHER_AMOUNT & ", " & _
                     "   EXPENSE_AMOUNT = " & EXPENSE_AMOUNT & ", " & _
                    "    MODIFY_DATE = '" & ServerDateTime & "', " & _
                    "    MODIFY_BY = " & glbUser.USER_ID & " " & _
                     "WHERE DO_ITEM_ID = " & DO_ITEM_ID
   End If
   If (AddEditMode = SHOW_ADD) Or (AddEditMode = SHOW_EDIT) Then
      m_Conn.Execute (SQL1)
   End If
End Function

Public Function DeleteData()
Dim SQL1 As String
      SQL1 = "DELETE FROM DO_ITEM WHERE DO_ITEM_ID = " & DO_ITEM_ID
      m_Conn.Execute (SQL1)
End Function

Public Function PatchPigAge() As Boolean
Dim ServerDateTime As String
Dim SQL1 As String

   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL1 = "UPDATE DO_ITEM SET " & _
                  "   PIG_AGE = " & PIG_AGE & ", " & _
                  "   AGE_CODE = '" & Trim(ChangeQuote(AGE_CODE)) & "', " & _
                 "    MODIFY_DATE = '" & ServerDateTime & "', " & _
                 "    MODIFY_BY = " & glbUser.USER_ID & " " & _
                  "WHERE DO_ITEM_ID = " & DO_ITEM_ID
                  
   m_Conn.Execute (SQL1)
End Function
Public Sub SearchPartNo(WhereStr As String)
Dim SubLen As Long
Dim NewStr  As String
   
   If Trim(PART_NO) <> "" Then
      If WildCard(PART_NO, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
         Else
            WhereStr = WhereStr & "AND (PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
         End If
      End If
   End If
End Sub
Public Sub UpdateBirthCost()
Dim ServerDateTime As String
Dim SQL1 As String
      
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL1 = "UPDATE DO_ITEM SET " & _
                  "   BIRTH_AMOUNT = " & BIRTH_AMOUNT & ", " & _
                  "    MODIFY_DATE = '" & ServerDateTime & "', " & _
                 "    MODIFY_BY = " & glbUser.USER_ID & " " & _
                  "WHERE DO_ITEM_ID = " & DO_ITEM_ID
   m_Conn.Execute (SQL1)
End Sub
